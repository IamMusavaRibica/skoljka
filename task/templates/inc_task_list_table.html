{% load pagination_tags %}
{% load sorting_tags %}

{% load task_tags %}
{% load rating_tags %}

{% autosort tasks %}
{% autopaginate tasks %}

{% if tasks %}
    {{ tasks|multiple_task_link }}<br>
    
    {% if user.profile.selected_folder %}
    <script>
    $(function(){
     $('.folder_checkbox').click(function(){
      $.ajax({
        url: '/folder/select/task/' + $(this).parent().next().html() + '/'
      });
     });
    });
    </script>
    {% endif %}
    
    <table width="100%" class="table-striped table-condensed" style="text-align: center;">
    <tr>
        <th colspan="{% if user.profile.selected_folder %}8{% else %}7{% endif %}">Lista zadataka</th>
    </tr>
    <tr>
        {% if user.profile.selected_folder %}<th width="50">U mapi</th>{% endif %}
        <th width="50">{% anchor id # %}</th>
        <th>Naslov</th>
        <th>Tagovi</th>
        <th>{% anchor solved_count Rj. %}</th>
        {% if search_solved_count %}<th>(Rj.)</th>{% endif %}
        <th>{% anchor quality_rating_avg Kvaliteta %}</th>
        <th>{% anchor difficulty_rating_avg Te≈æina %}</th>
    </tr>

    {% for task in tasks|cache_additional_info:user %}
    <tr class="{% if task.cache_solution %}{{ task.cache_solution.get_html_info.tr_class }}{% else %}{% if task.hidden %}task_hidden{% endif %}{% endif %}">
        {% if user.profile.selected_folder %}
            <td><input type="checkbox" class="folder_checkbox"{% if task.is_in_folder %} checked="checked"{% endif %}></td>
        {% endif %}
        <td style="text-align:center;">{{ task.id }}</td>
        <td>{{ task.get_link }}</td>
        <td>{% if plus_exclude %}{% tag_list task plus_exclude %}{% else %}{% tag_list task %}{% endif %}</td>
        {% if task.solved_count > 0 %}
            <td><a href="/solution/task/{{ task.id }}/">{{ task.solved_count }}</a></td>
        {% else %}
            <td>0</td>
        {% endif %}
        {% if search_solved_count %}<td>{{ task.search_solved_count }}</td>{% endif %}
        <td style="width:80px;">{{ task.quality_rating|rating_stars }}</td>
        <td style="width:80px;">{{ task.difficulty_rating|rating_stars }}</td>
    </tr>
    {% endfor %}
    </table>
    {% paginate %}
{% else %}
    {% if empty_message %}{{ empty_message }}{% endif %}
{% endif %}
