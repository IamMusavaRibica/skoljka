from django import templatefrom django.utils.safestring import mark_safefrom django.contrib.contenttypes.models import ContentTyperegister = template.Library()@register.inclusion_tag('inc_rating_box.html', takes_context=True)def rating_box(context, text, manager):    user_vote = manager.get_vote_for_user(context['request'].user)    return {        'text': text,        'm': manager,        'user_vote': None if user_vote is None else user_vote.value    }#@register.inclusion_tag('inc_rating_input.html')#def rating_input(name, range_and_titles, star_split, value):#    return { 'name': name, 'range_and_titles': range_and_titles, 'star_split': star_split, 'value': value }@register.filterdef rating_stars(manager):    average = getattr(manager.instance, '%s_avg' % manager.field.name)    left = int(80 * average / float(manager.field.range))    return mark_safe(        '<div class="readonly-star" style="background-position:0px -32px;width:%(left)spx;" title="%(avg).1f"></div> \         <div class="readonly-star" style="background-position:-%(left)spx 0px;width:%(right)spx;" title="%(avg).1f"></div>' % {            'left': left, 'right': int(80 - left), 'avg': average        })